---
title: "Reproducible Research: Peer Assessment 1"   
output: 
  html_document:
    keep_md: true
---
    
#### Author: Hernan Gianini
#### Last update: March 2022  
#   
## Loading and preprocessing the data  
```{r echo=TRUE,warning=FALSE,message=FALSE,error=FALSE}
library(tidyverse)
library(scales)
activity <- read.csv("activity.csv",header=TRUE)
activity <- mutate(activity,time=sprintf("%04d",interval))
activity <- mutate(activity,datetime=strptime(paste0(date,time),"%Y-%m-%d%H%M"))
activity$date <- as.Date(activity$date,"%Y-%m-%d")
activity$time <- paste(substr(activity$time,1,2),substr(activity$time,3,4),sep=":")
activity$time2 <- strptime(activity$time,"%H:%M")
```

#
## What is mean total number of steps taken per day?
```{r echo=TRUE,warning=FALSE,message=FALSE,error=FALSE}
totalstepsday <- activity %>% group_by(date) %>% 
    summarize(total=sum(steps,na.rm=TRUE))
with(totalstepsday,
      ggplot(totalstepsday, aes(x=date, y=total)) + 
          geom_bar(stat="identity", width=.8) + 
          labs(title="Total steps per day histogram") + 
          xlab("Date") + ylab("Total steps") + 
          scale_x_date(breaks = date[seq(1, length(date), by = 2)]) + 
          theme(axis.text.x=element_text(angle=90,vjust=0.5,hjust=0.5,size=7))
     )
```

For the total number of steps taken per day:  
- The mean:  
```{r echo=TRUE,warning=FALSE,message=FALSE,error=FALSE}
mean(totalstepsday$total,na.rm=TRUE)
```
- The median:  
```{r echo=TRUE,warning=FALSE,message=FALSE,error=FALSE}
median(totalstepsday$total,na.rm=TRUE)
```
  
## What is the average daily activity pattern?  
```{r echo=TRUE,warning=FALSE,message=FALSE,error=FALSE}
minintmean <- activity %>% group_by(interval,time2) %>% summarize(intmean = mean(steps,na.rm=TRUE))
ggplot(minintmean,aes(x=as.POSIXct(time2,tz="GMT"),y=intmean)) + 
    geom_line() + 
    xlab("Time interval") + 
    ylab("Average steps per time interval") + 
    scale_x_datetime(date_breaks="1 hour",labels= date_format("%H:%M"),timezone="UTC") + 
    theme(axis.text.x=element_text(angle=90,vjust=0.5,hjust=0.5,size=7))
```
    
5-minute interval, on average across all the days in the dataset, wich contains the maximum number of steps:  
```{r echo=TRUE,warning=FALSE,message=FALSE,error=FALSE}
maxsteps <- max(minintmean$intmean)
maxinterval <- minintmean[minintmean$intmean == maxsteps, ]$time2
format(as.POSIXct(maxinterval), format = "%H:%M")
```

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
